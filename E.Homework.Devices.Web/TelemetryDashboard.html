<!DOCTYPE html>
<html>
<head>
    <script type="text/javascript" src="Scripts/mapcontrol.js"></script>
    <!--<script src="Scripts/jquery-1.6.4.min.js"></script>-->
    <script src="Scripts/jquery-1.6.4.min.js"></script>
    <script src="Scripts/jquery.signalR-2.2.2.min.js"></script>
    <script src="signalr/hubs"></script>       
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <meta charset="utf-8" />
    <title></title>
</head>
<body>
    <script type="text/javascript">


        google.charts.load('current', { 'packages': ['corechart'] });
        var googleLineChart = null;
        var tempData = null;

         

        class DashBoardChart {
            constructor(googleChart, dataTable) {
                this.googleChart = googleChart;
                this.dataTable = dataTable;
            };
        };

        function CreateChart(deviceId, Units) {

        }

        function UpdateChart(deviceId, date, value) {

            if (googleLineChart == null) {
                googleLineChart = new google.visualization.LineChart(document.getElementById('line_chart'));
            }

            if (tempData == null) {
                tempData = new google.visualization.DataTable();
                tempData.addColumn('date', 'Time')
                tempData.addColumn('number', "Temperature")
            }

            tempData.addRow([date, value]);

            var options = {
                title: 'Temperature live graph, C',
                curveType: 'function',
                dateFormat: 'dd.MM.yy hh:mm',
                //legend: { position: 'bottom' }
            };

            googleLineChart.draw(tempData, options);

        }

        $(function () {
            var telemetryHub = $.connection.telemetryHub;
            $.connection.hub.start();

            telemetryHub.client.updateDashboard = function (deviceId, units) {

            };

            telemetryHub.client.publishData = function (deviceId, data, units) {
                UpdateChart(deviceId, new Date(), Number(data));
            }
        })


    </script>

    <div id="line_chart" class="map-container" style="float:left; width: 500px; height: 500px"></div>

</body>
</html>